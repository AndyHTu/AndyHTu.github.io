<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Prompt Studio — Images & Video</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="A lightweight, character‑aware prompt builder for images and video. Save characters, pick a location or vibe, and auto‑compose prompts for Midjourney, Higgsfield, and more." />
  <style>
    .kbd{border:1px solid rgb(229,231,235);border-bottom-width:3px;border-radius:.5rem;padding:.1rem .4rem;background:white}
    .mono{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
  </style>
</head>
<body class="bg-zinc-50 text-zinc-900">
  <!-- Header -->
  <header class="sticky top-0 z-10 bg-white/90 backdrop-blur border-b border-zinc-200">
    <div class="mx-auto max-w-6xl px-4 py-4 flex items-center justify-between">
      <h1 class="text-xl font-semibold tracking-tight">AI Prompt Studio <span class="text-zinc-400">(Images & Video)</span></h1>
      <nav class="text-sm text-zinc-500 hidden md:flex gap-6">
        <a class="hover:text-zinc-800" href="#image">Image</a>
        <a class="hover:text-zinc-800" href="#video">Video</a>
        <a class="hover:text-zinc-800" href="#characters">Characters</a>
        <a class="hover:text-zinc-800" href="#about">About</a>
      </nav>
    </div>
  </header>

  <main class="mx-auto max-w-6xl px-4 py-6 space-y-8">
    <!-- Quick Intro / Tips -->
    <section id="about" class="grid md:grid-cols-3 gap-4">
      <div class="md:col-span-2 bg-white rounded-2xl shadow-sm border border-zinc-200 p-5">
        <h2 class="text-lg font-semibold mb-2">What this is</h2>
        <p class="text-sm text-zinc-600">A single‑file app you can host on <span class="mono">username.github.io</span> to quickly build structured prompts. It supports: character presets (looks + voice/personality), location/vibe shorthands, and platform‑aware formatting for Midjourney & Higgsfield. Everything saves to your browser <span class="mono">localStorage</span>.</p>
      </div>
      <div class="bg-white rounded-2xl shadow-sm border border-zinc-200 p-5">
        <h3 class="text-sm font-semibold mb-2">Hotkeys</h3>
        <ul class="text-sm text-zinc-600 space-y-1">
          <li><span class="kbd">Ctrl</span>+<span class="kbd">Enter</span> — Compose</li>
          <li><span class="kbd">Ctrl</span>+<span class="kbd">C</span> — Copy Output</li>
          <li><span class="kbd">/</span> — Focus search</li>
        </ul>
      </div>
    </section>

    <!-- Character Manager -->
    <section id="characters" class="bg-white rounded-2xl shadow-sm border border-zinc-200 p-5">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-semibold">Characters</h2>
        <div class="flex gap-2">
          <button id="exportChars" class="px-3 py-2 text-sm rounded-xl bg-zinc-900 text-white">Export JSON</button>
          <label class="px-3 py-2 text-sm rounded-xl bg-zinc-100 border border-zinc-200 cursor-pointer">Import JSON<input id="importChars" type="file" accept="application/json" class="hidden"></label>
        </div>
      </div>
      <div class="grid md:grid-cols-2 gap-4">
        <div class="space-y-3">
          <label class="block text-sm font-medium">Select</label>
          <select id="characterSelect" class="w-full rounded-xl border-zinc-300 focus:ring-0">
          </select>
          <div class="flex gap-2">
            <button id="saveCharacter" class="px-3 py-2 text-sm rounded-xl bg-zinc-900 text-white">Save</button>
            <button id="newCharacter" class="px-3 py-2 text-sm rounded-xl bg-zinc-100 border">New</button>
            <button id="deleteCharacter" class="px-3 py-2 text-sm rounded-xl bg-rose-600 text-white">Delete</button>
          </div>
        </div>
        <div class="grid grid-cols-1 gap-3">
          <div>
            <label class="block text-sm font-medium">Name</label>
            <input id="c_name" class="w-full rounded-xl border-zinc-300" placeholder="Asami Freya"/>
          </div>
          <div>
            <label class="block text-sm font-medium">Appearance (visual DNA)</label>
            <textarea id="c_appearance" rows="3" class="w-full rounded-xl border-zinc-300" placeholder="Girl with very long black silky hair, bangs, blue eyes; athletic; matte skin; light freckles; signature outfits, etc."></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium">Personality / Voice</label>
            <textarea id="c_personality" rows="2" class="w-full rounded-xl border-zinc-300" placeholder="soft‑spoken, playful, witty, gentle teasing, ASMR‑like tone"></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium">Negative Prompts (defaults)</label>
            <input id="c_neg" class="w-full rounded-xl border-zinc-300" placeholder="watermark, oversmooth skin, extra fingers, deformed hands"/>
          </div>
          <div>
            <label class="block text-sm font-medium">Image Style Defaults</label>
            <input id="c_imgstyle" class="w-full rounded-xl border-zinc-300" placeholder="cinematic, natural light, 50mm, handheld, candid"/>
          </div>
          <div>
            <label class="block text-sm font-medium">Video Style Defaults</label>
            <input id="c_vidstyle" class="w-full rounded-xl border-zinc-300" placeholder="10s, real‑time, subtle camera sway, diegetic audio"/>
          </div>
        </div>
      </div>
    </section>

    <!-- Image Prompt Builder -->
    <section id="image" class="bg-white rounded-2xl shadow-sm border border-zinc-200 p-5">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-semibold">Image Prompt Builder</h2>
        <div class="flex gap-2 text-sm">
          <select id="imgPlatform" class="rounded-xl border-zinc-300">
            <option value="midjourney">Midjourney</option>
            <option value="higgsfield">Higgsfield</option>
            <option value="generic">Generic</option>
          </select>
          <button id="composeImage" class="px-3 py-2 rounded-xl bg-zinc-900 text-white">Compose</button>
          <button id="copyImage" class="px-3 py-2 rounded-xl bg-zinc-100 border">Copy</button>
        </div>
      </div>
      <div class="grid md:grid-cols-3 gap-4">
        <div class="md:col-span-2 grid grid-cols-1 gap-3">
          <div>
            <label class="block text-sm font-medium">Location / Scene</label>
            <input id="img_location" class="w-full rounded-xl border-zinc-300" placeholder="Mall at Valley Fair, San Jose — or just 'club', 'rooftop', 'alley'" />
          </div>
          <div>
            <label class="block text-sm font-medium">Action / Pose</label>
            <input id="img_action" class="w-full rounded-xl border-zinc-300" placeholder="leaning on railing, candid laugh, adjusting hoodie, boxing stance" />
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="block text-sm font-medium">Framing</label>
              <input id="img_framing" class="w-full rounded-xl border-zinc-300" placeholder="50mm portrait, waist‑up, handheld" />
            </div>
            <div>
              <label class="block text-sm font-medium">Lighting</label>
              <input id="img_light" class="w-full rounded-xl border-zinc-300" placeholder="soft window light, neon edge light" />
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium">Look / Texture</label>
            <input id="img_look" class="w-full rounded-xl border-zinc-300" placeholder="matte skin, visible pores, film grain, shallow DOF" />
          </div>
          <div>
            <label class="block text-sm font-medium">Negatives (optional)</label>
            <input id="img_neg" class="w-full rounded-xl border-zinc-300" placeholder="over‑retouch, plastic skin, watermark" />
          </div>
        </div>
        <aside class="bg-zinc-50 border border-zinc-200 rounded-2xl p-4">
          <h3 class="text-sm font-semibold mb-2">Shortcuts</h3>
          <div class="flex flex-wrap gap-2 text-xs">
            <button data-fill="#img_location" data-text="Westfield Valley Fair, San Jose" class="px-2 py-1 rounded-lg border">Valley Fair</button>
            <button data-fill="#img_location" data-text="neon nightclub dance floor" class="px-2 py-1 rounded-lg border">Club</button>
            <button data-fill="#img_look" data-text="matte skin, visible pores, tiny blemishes kept" class="px-2 py-1 rounded-lg border">Anti‑Plastic</button>
            <button data-fill="#img_framing" data-text="35mm environmental portrait, handheld" class="px-2 py-1 rounded-lg border">35mm Env</button>
          </div>
        </aside>
      </div>
      <div class="mt-4">
        <label class="block text-sm font-medium">Output</label>
        <textarea id="img_output" rows="6" class="mono w-full rounded-2xl border-zinc-300 p-3" placeholder="Your composed prompt will appear here..."></textarea>
      </div>
    </section>

    <!-- Video Prompt Builder -->
    <section id="video" class="bg-white rounded-2xl shadow-sm border border-zinc-200 p-5">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-semibold">Video Prompt Builder</h2>
        <div class="flex gap-2 text-sm">
          <select id="vidPlatform" class="rounded-xl border-zinc-300">
            <option value="generic">Generic</option>
            <option value="kling">Kling / Runway‑style</option>
          </select>
          <button id="composeVideo" class="px-3 py-2 rounded-xl bg-zinc-900 text-white">Compose</button>
          <button id="copyVideo" class="px-3 py-2 rounded-xl bg-zinc-100 border">Copy</button>
        </div>
      </div>
      <div class="grid md:grid-cols-3 gap-4">
        <div class="md:col-span-2 grid grid-cols-1 gap-3">
          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="block text-sm font-medium">Duration</label>
              <input id="vid_duration" class="w-full rounded-xl border-zinc-300" placeholder="10s" />
            </div>
            <div>
              <label class="block text-sm font-medium">Playback</label>
              <input id="vid_speed" class="w-full rounded-xl border-zinc-300" placeholder="real‑time (no slow‑mo)" />
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium">Scene Idea</label>
            <input id="vid_scene" class="w-full rounded-xl border-zinc-300" placeholder="Asami shadowboxing playfully in mall parking garage, neon spill" />
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="block text-sm font-medium">Camera</label>
              <input id="vid_camera" class="w-full rounded-xl border-zinc-300" placeholder="handheld, 50mm, gentle forward drift, slight dutch tilt" />
            </div>
            <div>
              <label class="block text-sm font-medium">Lighting / Mood</label>
              <input id="vid_light" class="w-full rounded-xl border-zinc-300" placeholder="sodium vapor + cyan neon, rainy asphalt reflections" />
            </div>
          </div>
          <div class="grid grid-cols-2 gap-3">
            <div>
              <label class="block text-sm font-medium">Audio</label>
              <input id="vid_audio" class="w-full rounded-xl border-zinc-300" placeholder="diegetic ambient mall hum, soft breath, sneaker squeaks" />
            </div>
            <div>
              <label class="block text-sm font-medium">Negatives</label>
              <input id="vid_neg" class="w-full rounded-xl border-zinc-300" placeholder="no slow‑motion, no lens flares, no glitches" />
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium">Trends / Hooks (optional)</label>
            <input id="vid_trends" class="w-full rounded-xl border-zinc-300" placeholder="IG: #nightluxe #lofilooks — X: #mallcore" />
          </div>
        </div>
        <aside class="bg-zinc-50 border border-zinc-200 rounded-2xl p-4">
          <h3 class="text-sm font-semibold mb-2">Beats Template</h3>
          <ul class="text-xs text-zinc-600 space-y-1">
            <li><b>0–2s</b>: establishing shot</li>
            <li><b>2–6s</b>: action loop / hero moment</li>
            <li><b>6–8s</b>: closeup detail (hands/eyes)</li>
            <li><b>8–10s</b>: button / logo / wink</li>
          </ul>
        </aside>
      </div>
      <div class="mt-4">
        <label class="block text-sm font-medium">Output</label>
        <textarea id="vid_output" rows="8" class="mono w-full rounded-2xl border-zinc-300 p-3" placeholder="Your composed prompt will appear here..."></textarea>
      </div>
    </section>

    <!-- Footer -->
    <footer class="text-xs text-zinc-500 py-6">
      <p>Made for rapid AI content workflows. All data stays in your browser. Add more platforms/fields later as needed.</p>
    </footer>
  </main>

  <script>
    // --- Storage helpers ---
    const LS_KEY = 'ai_prompt_studio_chars_v1';
    const $ = (sel) => document.querySelector(sel);

    function loadChars(){
      try{ return JSON.parse(localStorage.getItem(LS_KEY)) || []; }catch{ return []; }
    }
    function saveChars(chars){ localStorage.setItem(LS_KEY, JSON.stringify(chars)); }

    // --- Default character: Asami ---
    const DEFAULT_ASAMI = {
      name: 'Asami Freya',
      appearance: 'Girl with very long black silky hair, bangs, blue eyes; voluptuous yet athletic build; matte skin with visible pores; light freckles; subtle scar on left hip; signature streetwear (oversized sweatpants, low V‑neck tank), sneakers, occasional boxing gloves.',
      personality: 'soft‑spoken, playful, witty, gentle teasing; calm ASMR‑like cadence; confident but kind; a little tomboy energy.',
      negatives: 'watermark, plastic skin, oversharpen, extra fingers, deformed hands, censor bars, text artifacts',
      imgstyle: 'cinematic, natural light or soft neon, 35–50mm, handheld, candid framing, film grain',
      vidstyle: '10s, real‑time, subtle handheld sway, natural foley, tight cuts at 2–3s beats'
    };

    // --- UI state ---
    let characters = loadChars();
    if(!characters.length){ characters = [DEFAULT_ASAMI]; saveChars(characters); }

    function refreshSelect(){
      const sel = $('#characterSelect');
      sel.innerHTML = characters.map((c,i)=>`<option value="${i}">${c.name}</option>`).join('');
      sel.value = '0';
      fillForm(characters[0]);
    }

    function fillForm(c){
      $('#c_name').value = c.name || '';
      $('#c_appearance').value = c.appearance || '';
      $('#c_personality').value = c.personality || '';
      $('#c_neg').value = c.negatives || '';
      $('#c_imgstyle').value = c.imgstyle || '';
      $('#c_vidstyle').value = c.vidstyle || '';
    }

    function readForm(){
      return {
        name: $('#c_name').value.trim(),
        appearance: $('#c_appearance').value.trim(),
        personality: $('#c_personality').value.trim(),
        negatives: $('#c_neg').value.trim(),
        imgstyle: $('#c_imgstyle').value.trim(),
        vidstyle: $('#c_vidstyle').value.trim(),
      };
    }

    // --- Character CRUD ---
    $('#characterSelect').addEventListener('change', e=>{
      const idx = +e.target.value; fillForm(characters[idx]);
    });

    $('#saveCharacter').addEventListener('click', ()=>{
      const idx = +$('#characterSelect').value; characters[idx] = readForm(); saveChars(characters); refreshSelect();
    });

    $('#newCharacter').addEventListener('click', ()=>{
      const c = readForm(); if(!c.name) c.name = `Character ${characters.length+1}`; characters.push(c); saveChars(characters); refreshSelect();
    });

    $('#deleteCharacter').addEventListener('click', ()=>{
      if(characters.length<=1){ alert('Keep at least one character.'); return; }
      const idx = +$('#characterSelect').value; characters.splice(idx,1); saveChars(characters); refreshSelect();
    });

    $('#exportChars').addEventListener('click', ()=>{
      const blob = new Blob([JSON.stringify(characters,null,2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'characters.json'; a.click(); URL.revokeObjectURL(url);
    });

    $('#importChars').addEventListener('change', (e)=>{
      const file = e.target.files[0]; if(!file) return; const reader = new FileReader();
      reader.onload = ()=>{ try{ const data = JSON.parse(reader.result); if(Array.isArray(data)){ characters = data; saveChars(characters); refreshSelect(); } }catch{ alert('Invalid JSON'); } };
      reader.readAsText(file);
    });

    // --- Helpers ---
    function joinParts(parts){ return parts.filter(Boolean).map(s=>s.trim()).filter(Boolean).join(', '); }

    function platformWrap(text, platform){
      if(platform==='midjourney'){
        // Simple MJ helpers; extend as you like
        return `${text} --ar 3:4 --v 6`;
      }
      if(platform==='higgsfield'){
        return text; // Higgsfield often reads plain natural language well
      }
      return text;
    }

    function currentChar(){ return characters[+$('#characterSelect').value] || DEFAULT_ASAMI; }

    // --- Image Composer ---
    function composeImage(){
      const ch = currentChar();
      const location = $('#img_location').value;
      const action = $('#img_action').value;
      const framing = $('#img_framing').value || ch.imgstyle;
      const light = $('#img_light').value;
      const look = $('#img_look').value;
      const neg = joinParts([$('#img_neg').value, ch.negatives]);

      const subject = `${ch.name}: ${ch.appearance}. Personality: ${ch.personality}.`;
      const scene = joinParts([location, action, framing, light, look]);

      let prompt = `${subject} ${scene ? `— ${scene}` : ''}. ${neg?`Negative: ${neg}.`:''}`.trim();
      prompt = platformWrap(prompt, $('#imgPlatform').value);
      $('#img_output').value = prompt;
    }

    // --- Video Composer ---
    function composeVideo(){
      const ch = currentChar();
      const duration = $('#vid_duration').value || (ch.vidstyle.match(/\d+s/)||['10s'])[0];
      const speed = $('#vid_speed').value || 'real‑time';
      const scene = $('#vid_scene').value;
      const camera = $('#vid_camera').value;
      const light = $('#vid_light').value;
      const audio = $('#vid_audio').value;
      const neg = joinParts([$('#vid_neg').value, ch.negatives]);
      const trends = $('#vid_trends').value;

      const header = `${ch.name}: ${ch.appearance}. Personality: ${ch.personality}.`;
      const beats = `Duration ${duration}, ${speed}. Camera: ${camera}. Lighting: ${light}. Audio: ${audio}.`;
      const body = scene ? `Scene: ${scene}.` : '';
      const trendLine = trends ? `Trends/Hooks: ${trends}.` : '';

      let out = `${header}\n${beats}\n${body}\n${trendLine}\n${neg?`Negative: ${neg}.`:''}`.trim();
      $('#vid_output').value = out;
    }

    // --- Shortcuts, Copy, Hotkeys ---
    document.querySelectorAll('[data-fill]').forEach(btn=>{
      btn.addEventListener('click',()=>{
        const target = btn.getAttribute('data-fill');
        const text = btn.getAttribute('data-text');
        const el = document.querySelector(target); if(!el) return; el.value = text;
      });
    });

    $('#composeImage').addEventListener('click', composeImage);
    $('#composeVideo').addEventListener('click', composeVideo);

    async function copy(sel){
      const el = $(sel); el.select(); try{ await navigator.clipboard.writeText(el.value); el.blur(); }catch{ document.execCommand('copy'); }
    }
    $('#copyImage').addEventListener('click', ()=>copy('#img_output'));
    $('#copyVideo').addEventListener('click', ()=>copy('#vid_output'));

    document.addEventListener('keydown', (e)=>{
      if(e.key==='Enter' && e.ctrlKey){
        if(document.activeElement && document.activeElement.closest('#image')) composeImage();
        else if(document.activeElement && document.activeElement.closest('#video')) composeVideo();
      }
      if(e.key.toLowerCase()==='c' && e.ctrlKey){
        if(document.activeElement && document.activeElement.closest('#image')) $('#copyImage').click();
        else if(document.activeElement && document.activeElement.closest('#video')) $('#copyVideo').click();
      }
      if(e.key==='/' && !e.target.matches('input, textarea')){ e.preventDefault(); $('#img_location').focus(); }
    });

    // Init
    refreshSelect();
  </script>
</body>
</html>
